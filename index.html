<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üê≠ M√§use-Labyrinth Abenteuer</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Arial', sans-serif;
            background: linear-gradient(to bottom, #fef3c7, #fed7aa);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            touch-action: pan-y pinch-zoom;
        }
        
        .game-container {
            text-align: center;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            padding: 30px;
            max-width: 600px;
            touch-action: none;
        }
        
        h1 {
            font-size: 2.5rem;
            color: #92400e;
            margin-bottom: 10px;
            font-family: serif;
        }
        
        .instructions {
            color: #b45309;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        
        .score-board {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #92400e;
        }
        
        .maze-container {
            position: relative;
            border: 4px solid #78716c;
            border-radius: 10px;
            background: linear-gradient(135deg, #d6d3d1, #a8a29e);
            margin: 0 auto 20px;
            display: inline-block;
            max-width: 95vw;
            overflow: hidden;
        }
        
        .maze-cell {
            position: absolute;
            width: 32px;
            height: 32px;
        }
        
        .wall {
            background: linear-gradient(135deg, #57534e, #44403c);
            border: 1px solid #78716c;
        }
        
        .path {
            background: linear-gradient(135deg, #fef3c7, #fef9e7);
        }
        
        .player {
            position: absolute;
            width: 28px;
            height: 28px;
            left: 2px;
            top: 2px;
            transition: all 0.15s ease-out;
            z-index: 10;
        }
        
        .mouse {
            position: relative;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #d1d5db, #9ca3af);
            border: 2px solid #4b5563;
            border-radius: 50%;
            margin: 2px;
        }
        
        .mouse::before,
        .mouse::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            background: linear-gradient(135deg, #d1d5db, #9ca3af);
            border: 1px solid #4b5563;
            border-radius: 50%;
            top: -4px;
        }
        
        .mouse::before { left: -4px; }
        .mouse::after { right: -4px; }
        
        .mouse-eyes {
            position: absolute;
            top: 4px;
        }
        
        .mouse-eye {
            width: 4px;
            height: 4px;
            background: black;
            border-radius: 50%;
            position: absolute;
        }
        
        .mouse-eye:first-child { left: 4px; }
        .mouse-eye:last-child { right: 4px; }
        
        .mouse-nose {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 2px;
            background: #f472b6;
            border-radius: 50%;
        }
        
        .mouse-tail {
            position: absolute;
            top: 12px;
            left: 24px;
            width: 16px;
            height: 2px;
            background: linear-gradient(to right, #9ca3af, #d1d5db);
            border-radius: 1px;
            transform: rotate(12deg);
        }
        
        .cheese {
            position: absolute;
            width: 20px;
            height: 16px;
            background: linear-gradient(135deg, #fde047, #eab308);
            border: 1px solid #ca8a04;
            border-radius: 3px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(12deg);
            z-index: 5;
        }
        
        .cheese::before,
        .cheese::after {
            content: '';
            position: absolute;
            background: #fef3c7;
            border-radius: 50%;
        }
        
        .cheese::before {
            width: 4px;
            height: 4px;
            top: 2px;
            left: 4px;
        }
        
        .cheese::after {
            width: 2px;
            height: 2px;
            top: 6px;
            right: 2px;
        }
        
        .cheese-sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            top: -4px;
            right: -4px;
            opacity: 0.75;
            animation: sparkle 1s infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0.75; }
            50% { opacity: 0.3; }
        }
        
        .win-message {
            background: #dcfce7;
            border: 2px solid #16a34a;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .win-message.show {
            display: block;
        }
        
        .win-message h2 {
            color: #15803d;
            margin-bottom: 10px;
        }
        
        .win-message p {
            color: #166534;
            margin-bottom: 15px;
        }
        
        .reset-button {
            background: #16a34a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .reset-button:hover {
            background: #15803d;
        }
        
        .controls {
            margin-top: 20px;
            color: #b45309;
        }
        
        .controls p {
            margin: 5px 0;
        }

        /* Mobile Touch Controls */
        .mobile-controls {
            display: none;
            margin-top: 20px;
            justify-content: center;
            gap: 10px;
        }

        .control-pad {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
            gap: 5px;
            width: 150px;
            height: 150px;
        }

        .control-btn {
            background: #92400e;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
            touch-action: manipulation;
            user-select: none;
        }

        .control-btn:hover, .control-btn:active {
            background: #b45309;
        }

        .control-btn.up { grid-column: 2; grid-row: 1; }
        .control-btn.left { grid-column: 1; grid-row: 2; }
        .control-btn.right { grid-column: 3; grid-row: 2; }
        .control-btn.down { grid-column: 2; grid-row: 3; }

        /* Show mobile controls on touch devices */
        @media (hover: none) and (pointer: coarse) {
            .mobile-controls {
                display: flex;
            }
            .controls {
                font-size: 0.9rem;
            }
        }

        /* Better mobile layout */
        @media (max-width: 600px) {
            body {
                padding: 5px;
                min-height: 100vh;
                justify-content: flex-start;
            }
            .game-container {
                padding: 10px;
                margin: 2px;
                max-width: 98vw;
                box-sizing: border-box;
                min-height: auto;
            }
            h1 {
                font-size: 1.6rem;
                margin-bottom: 5px;
            }
            .instructions {
                font-size: 0.8rem;
                margin-bottom: 10px;
            }
            .score-board {
                font-size: 0.9rem;
                margin-bottom: 10px;
            }
            .maze-container {
                transform: scale(0.28);
                transform-origin: center;
                margin: -65px auto -38px;
                max-width: 72vw;
            }
            .control-pad {
                width: 110px;
                height: 110px;
                gap: 3px;
            }
            .control-btn {
                font-size: 0.9rem;
            }
            .controls {
                margin-top: 10px;
            }
            .controls p {
                margin: 3px 0;
                font-size: 0.8rem;
            }
        }

        /* iPhone 12 Pro specific (390px) */
        @media (max-width: 400px) and (min-width: 375px) {
            .maze-container {
                transform: scale(0.11);
                margin: -115px auto -63px;
                max-width: 55vw;
            }
        }

        @media (max-width: 400px) {
            body {
                padding: 1px;
            }
            .game-container {
                padding: 6px;
                margin: 1px;
                max-width: 99vw;
            }
            h1 {
                font-size: 1.3rem;
                margin-bottom: 3px;
            }
            .instructions {
                font-size: 0.7rem;
                margin-bottom: 6px;
            }
            .score-board {
                font-size: 0.75rem;
                margin-bottom: 6px;
            }
            .maze-container {
                transform: scale(0.13);
                margin: -105px auto -58px;
                max-width: 58vw;
            }
            .control-pad {
                width: 85px;
                height: 85px;
                gap: 2px;
            }
            .control-btn {
                font-size: 0.75rem;
            }
            .controls p {
                font-size: 0.65rem;
                margin: 2px 0;
            }
            .win-message {
                padding: 8px;
            }
        }

        /* Ultra small screens (iPhone SE, etc) */
        @media (max-width: 350px) {
            body {
                padding: 1px;
            }
            .game-container {
                padding: 4px;
                margin: 0px;
                max-width: 100vw;
            }
            h1 {
                font-size: 1.1rem;
                margin-bottom: 2px;
            }
            .instructions {
                font-size: 0.6rem;
                margin-bottom: 4px;
            }
            .score-board {
                font-size: 0.7rem;
                margin-bottom: 4px;
            }
            .maze-container {
                transform: scale(0.09);
                margin: -125px auto -68px;
                max-width: 52vw;
            }
            .control-pad {
                width: 75px;
                height: 75px;
                gap: 1px;
            }
            .control-btn {
                font-size: 0.7rem;
            }
            .controls p {
                font-size: 0.6rem;
                margin: 1px 0;
            }
            .win-message {
                padding: 6px;
                margin-top: 8px;
            }
            .win-message h2 {
                font-size: 1.1rem;
            }
            .win-message p {
                font-size: 0.75rem;
            }
        }

        /* MEGA AGGRESSIVE f√ºr winzige Screens */
        @media (max-width: 320px) {
            .maze-container {
                transform: scale(0.08);
                margin: -130px auto -70px;
                max-width: 50vw;
            }
            h1 {
                font-size: 0.9rem;
            }
            .game-container {
                padding: 2px;
            }
            .control-pad {
                width: 60px;
                height: 60px;
            }
            .control-btn {
                font-size: 0.6rem;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>üê≠ M√§use-Labyrinth Abenteuer</h1>
        <p class="instructions">Hilf der kleinen Maus, durch das Labyrinth zu navigieren und alle K√§sest√ºcke zu sammeln!</p>
        
        <div class="score-board">
            <div>üßÄ K√§se: <span id="cheese-count">4</span></div>
            <div>Punkte: <span id="score">0</span></div>
        </div>
        
        <div class="maze-container" id="maze-container">
            <!-- Maze will be generated here -->
        </div>
        
        <div class="win-message" id="win-message">
            <h2>üéâ Herzlichen Gl√ºckwunsch! üéâ</h2>
            <p>Du hast alle K√§sest√ºcke gesammelt!</p>
            <button class="reset-button" onclick="resetGame()">Nochmal spielen</button>
        </div>

        <div class="mobile-controls">
            <div class="control-pad">
                <button class="control-btn up" onclick="movePlayer('up')">‚Üë</button>
                <button class="control-btn left" onclick="movePlayer('left')">‚Üê</button>
                <button class="control-btn right" onclick="movePlayer('right')">‚Üí</button>
                <button class="control-btn down" onclick="movePlayer('down')">‚Üì</button>
            </div>
        </div>

        <div class="controls">
            <p>üéÆ Steuerung: WASD, Pfeiltasten oder Touch-Buttons</p>
            <p>üßÄ Sammle alle K√§sest√ºcke um zu gewinnen!</p>
            <p>üì± iPhone optimiert! Wisch-Gesten oder Touch-Buttons nutzen!</p>
        </div>
    </div>

    <script>
        // Labyrinth Layout: 0 = Wand, 1 = Gang, 2 = K√§se
        const MAZE_LAYOUT = [
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
            [0,1,1,1,0,1,1,1,1,1,0,1,1,2,0],
            [0,1,0,1,0,1,0,0,0,1,0,1,0,1,0],
            [0,2,0,1,1,1,1,1,0,1,1,1,0,1,0],
            [0,1,0,0,0,0,0,1,0,0,0,1,0,1,0],
            [0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
            [0,0,0,1,0,0,0,0,0,1,0,0,0,1,0],
            [0,2,1,1,1,1,1,1,1,1,1,1,1,1,0],
            [0,1,0,1,0,0,0,0,0,0,0,1,0,2,0],
            [0,1,0,1,1,1,1,1,1,1,1,1,0,1,0],
            [0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],
            [0,1,1,1,1,1,1,1,1,1,1,1,1,1,0],
            [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
        ];

        const CELL_SIZE = 32;
        let playerPos = { x: 1, y: 1 };
        let maze = JSON.parse(JSON.stringify(MAZE_LAYOUT)); // Deep copy
        let score = 0;
        let gameWon = false;
        let cheeseCount = 0;

        function initGame() {
            const mazeContainer = document.getElementById('maze-container');
            mazeContainer.innerHTML = '';
            
            // Set maze container size
            mazeContainer.style.width = (maze[0].length * CELL_SIZE) + 'px';
            mazeContainer.style.height = (maze.length * CELL_SIZE) + 'px';
            
            // Count cheese
            cheeseCount = maze.flat().filter(cell => cell === 2).length;
            updateScore();
            
            // Create maze cells
            for (let y = 0; y < maze.length; y++) {
                for (let x = 0; x < maze[y].length; x++) {
                    const cell = document.createElement('div');
                    cell.className = 'maze-cell';
                    cell.style.left = (x * CELL_SIZE) + 'px';
                    cell.style.top = (y * CELL_SIZE) + 'px';
                    
                    if (maze[y][x] === 0) {
                        cell.classList.add('wall');
                    } else {
                        cell.classList.add('path');
                        if (maze[y][x] === 2) {
                            const cheese = document.createElement('div');
                            cheese.className = 'cheese';
                            cheese.innerHTML = '<div class="cheese-sparkle"></div>';
                            cell.appendChild(cheese);
                        }
                    }
                    
                    mazeContainer.appendChild(cell);
                }
            }
            
            // Create player
            const player = document.createElement('div');
            player.id = 'player';
            player.className = 'player';
            player.innerHTML = `
                <div class="mouse">
                    <div class="mouse-eyes">
                        <div class="mouse-eye"></div>
                        <div class="mouse-eye"></div>
                    </div>
                    <div class="mouse-nose"></div>
                    <div class="mouse-tail"></div>
                </div>
            `;
            mazeContainer.appendChild(player);
            
            updatePlayerPosition();
        }

        function updatePlayerPosition() {
            const player = document.getElementById('player');
            player.style.left = (playerPos.x * CELL_SIZE) + 'px';
            player.style.top = (playerPos.y * CELL_SIZE) + 'px';
        }

        function updateScore() {
            document.getElementById('cheese-count').textContent = cheeseCount;
            document.getElementById('score').textContent = score;
        }

        function movePlayer(direction) {
            if (gameWon) return;

            let newX = playerPos.x;
            let newY = playerPos.y;

            switch (direction) {
                case 'up':
                    newY = Math.max(0, playerPos.y - 1);
                    break;
                case 'down':
                    newY = Math.min(maze.length - 1, playerPos.y + 1);
                    break;
                case 'left':
                    newX = Math.max(0, playerPos.x - 1);
                    break;
                case 'right':
                    newX = Math.min(maze[0].length - 1, playerPos.x + 1);
                    break;
            }

            // Kollisionserkennung mit W√§nden
            if (maze[newY][newX] === 0) {
                return; // Keine Bewegung bei Kollision
            }

            // K√§se sammeln
            if (maze[newY][newX] === 2) {
                maze[newY][newX] = 1; // K√§se entfernen
                score += 100;
                cheeseCount--;
                updateScore();
                
                // Remove cheese from display
                const cells = document.querySelectorAll('.maze-cell');
                const cellIndex = newY * maze[0].length + newX;
                const cheese = cells[cellIndex].querySelector('.cheese');
                if (cheese) {
                    cheese.remove();
                }
            }

            playerPos = { x: newX, y: newY };
            updatePlayerPosition();

            // Gewinn-√úberpr√ºfung
            if (cheeseCount === 0 && score > 0) {
                gameWon = true;
                document.getElementById('win-message').classList.add('show');
            }
        }

        function resetGame() {
            playerPos = { x: 1, y: 1 };
            maze = JSON.parse(JSON.stringify(MAZE_LAYOUT));
            score = 0;
            gameWon = false;
            document.getElementById('win-message').classList.remove('show');
            initGame();
        }

        // Keyboard controls
        document.addEventListener('keydown', (event) => {
            switch (event.key) {
                case 'ArrowUp':
                case 'w':
                case 'W':
                    event.preventDefault();
                    movePlayer('up');
                    break;
                case 'ArrowDown':
                case 's':
                case 'S':
                    event.preventDefault();
                    movePlayer('down');
                    break;
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    event.preventDefault();
                    movePlayer('left');
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    event.preventDefault();
                    movePlayer('right');
                    break;
            }
        });

        // Touch/Swipe controls for mobile
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;
        let isGameTouch = false;

        function handleTouchStart(event) {
            // Check if touch is on game area
            const gameContainer = document.querySelector('.game-container');
            const rect = gameContainer.getBoundingClientRect();
            const touch = event.touches[0];
            
            if (touch.clientX >= rect.left && touch.clientX <= rect.right && 
                touch.clientY >= rect.top && touch.clientY <= rect.bottom) {
                isGameTouch = true;
                touchStartX = touch.clientX;
                touchStartY = touch.clientY;
                // Prevent page scrolling only for game area touches
                event.preventDefault();
                event.stopPropagation();
            } else {
                isGameTouch = false;
            }
        }

        function handleTouchMove(event) {
            if (isGameTouch) {
                // Prevent scrolling only when touching game area
                event.preventDefault();
                event.stopPropagation();
            }
        }

        function handleTouchEnd(event) {
            if (isGameTouch) {
                const touch = event.changedTouches[0];
                touchEndX = touch.clientX;
                touchEndY = touch.clientY;
                handleSwipe();
                event.preventDefault();
                event.stopPropagation();
            }
            isGameTouch = false;
        }

        function handleSwipe() {
            const minSwipeDistance = 30; // Reduced for easier mobile swiping
            const deltaX = touchEndX - touchStartX;
            const deltaY = touchEndY - touchStartY;

            if (Math.abs(deltaX) < minSwipeDistance && Math.abs(deltaY) < minSwipeDistance) {
                return; // Not a swipe
            }

            if (Math.abs(deltaX) > Math.abs(deltaY)) {
                // Horizontal swipe
                if (deltaX > 0) {
                    movePlayer('right');
                } else {
                    movePlayer('left');
                }
            } else {
                // Vertical swipe
                if (deltaY > 0) {
                    movePlayer('down');
                } else {
                    movePlayer('up');
                }
            }
        }

        // Add touch event listeners with better targeting
        document.addEventListener('touchstart', handleTouchStart, { passive: false });
        document.addEventListener('touchmove', handleTouchMove, { passive: false });
        document.addEventListener('touchend', handleTouchEnd, { passive: false });

        // Initialize game when page loads
        window.addEventListener('load', initGame);
    </script>
</body>
</html> 